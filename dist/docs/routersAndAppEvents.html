<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Giraffe - Barc's Backbone Framework</title>

    <!-- Stylesheets -->
    <link rel='stylesheet' type='text/css' href='css/style.css' />

    <!-- Scripts -->
    <!--[if lt IE 9]><script type="text/javascript" src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body>
  <div id="page-wrapper">
    <div class="row">
      <!-- Sidebar -->
      <section id="sidebar" class="col sidebar">
        
        <h2><a href="index.html">Giraffe</a></h2>
<h2><a href="api.html">API</a></h2>
<h2>Examples</h2>
<ul>
<li><a href="viewBasics.html">View Basics</a></li>
<li><a href="lifecycleManagement.html">Lifecycle Management</a></li>
<li><a href="documentEvents.html">Document Events</a></li>
<li><a href="dataEvents.html">Data Events</a></li>
<li><a href="viewUI.html">View UI</a></li>
<li><a href="menuExample.html">Menu Examples</a></li>
<li><a href="viewFlexibility.html">View Flexibility</a></li>
<li><a href="routersAndAppEvents.html">Router and App Events</a></li>
<li><a href="templateStrategies.html">Template Strategies</a></li>
</ul>

      </section>

      <!-- Main Body -->
      <article id="content" class="col content">
        <img id="logo" src="img/logo.png" />
        <p><div class='section-example'><h2>Routers and appEvents</h2>
<p>This example demonstrates how <strong>Giraffe.Router</strong> ties into the <code>appEvents</code> described in the <em>App Events</em> example.</p>
<pre><code class="js"><span class="keyword">var</span> App, ChildView;</code></pre>
<p><strong>Giraffe.App</strong> is a <strong>Giraffe.View</strong> that encapsulates an app. <strong>Giraffe.Router</strong> requires an app because it uses <code>appEvents</code> to communicate with your objects.</p>
<pre><code class="js">App = Giraffe.App.extend({</code></pre>
<p>In this example, clicking some links will change the window location hash, triggering an <code>appEvent</code> which shows a child view with a specific name. Here we make three links to the three child views and a container for the active child view.</p>
<pre><code class="js">  getHTML: <span class="keyword">function</span>() {
    <span class="keyword">var</span> html = <span class="string">''</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/1"&gt;show child view 1&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/2"&gt;show child view 2&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/3"&gt;show child view 3&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;div id="child-view-container"&gt;&lt;/div&gt;'</span>;
    <span class="keyword">return</span> html;
  },</code></pre>
<p>Any Giraffe object, including the app, can listen for <code>appEvents</code>. When a route is triggered, its corresponding <code>appEvent</code> is called. Note that the <code>route:</code> prefix is just a naming convention and is not required. This route event is defined in <code>Router.triggers</code> below.</p>
<pre><code class="js">  appEvents: {
    <span class="string">'route:childView'</span>: <span class="string">'showChildView'</span>,
    <span class="string">'all'</span>: <span class="keyword">function</span>() { console.log(<span class="string">'app event'</span>, arguments); } <span class="comment">// log to see what's happening</span>
    <span class="comment">// 'some:otherRoute': 'someFunctionName'</span>
    <span class="comment">// 'some:otherAppEvent': 'someOtherFunctionName'</span>
  },

  showChildView: <span class="keyword">function</span>(name) {
    <span class="keyword">this</span>.attach(<span class="keyword">new</span> ChildView({name: name}), {el: <span class="string">'#child-view-container'</span>, method: <span class="string">'html'</span>});
  }
});</code></pre>
<p>In this example, we&#39;re going to create a child view that simply displays its name and a color.</p>
<pre><code class="js">ChildView = Giraffe.View.extend({
  className: <span class="string">'child-view'</span>,

  initialize: <span class="keyword">function</span>(options) {
    <span class="keyword">this</span>.name = <span class="string">'child view '</span> + <span class="keyword">this</span>.options.name;
    <span class="keyword">var</span> color;
    <span class="keyword">if</span> (options.name === <span class="string">'1'</span>)
      color = <span class="string">'#e99'</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> (options.name === <span class="string">'2'</span>)
      color = <span class="string">'#9e9'</span>;
    <span class="keyword">else</span>
      color = <span class="string">'#99e'</span>;
    <span class="keyword">this</span>.$el.css(<span class="string">'background-color'</span>, color);
  },

  getHTML: <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="string">'&lt;h2&gt;'</span> + <span class="keyword">this</span>.name + <span class="string">'&lt;/h2&gt;'</span>;
  }
});</code></pre>
<p>It&#39;s time to create and attach the app.</p>
<pre><code class="js"><span class="keyword">var</span> app = <span class="keyword">new</span> App();
app.attachTo(<span class="string">'body'</span>);</code></pre>
<p>Here&#39;s our router. The <code>triggers</code> option maps routes to appEvents. The router will bind to the global app reference at <code>Giraffe.app</code>, the first one created, unless an option <code>{app: someApp}</code> is passed to the router.</p>
<pre><code class="js"><span class="keyword">var</span> router = <span class="keyword">new</span> Giraffe.Router({
  triggers: {
    <span class="string">'childView/:name'</span>: <span class="string">'route:childView'</span>
    <span class="comment">// 'someHashLocation/:andItsParams': 'some:appEvent'</span>
  }
  <span class="comment">// app: someApp // to set an app other than Giraffe.app</span>
});

router.app === Giraffe.app; <span class="comment">// =&gt; true</span>

<span class="comment">// Alternatively:</span>
<span class="comment">// var Router = Giraffe.Router.extend({triggers: {...}});</span>
<span class="comment">// var router = new Router();</span></code></pre>
<p>Almost finished! Let&#39;s start the Backbone history to get things rolling.</p>
<pre><code class="js">Backbone.history.start();</code></pre>
<p>The <strong>Giraffe.Router</strong> has one more trick up its sleeve: it gives you programmatic control over your routes. The function <code>router.cause</code> takes an <code>appEvent</code> and optional parameters, navigates to the corresponding route defined in the router, and then triggers the <code>appEvent</code>. No longer must you manually build route links! Here we show <em>child view 1</em> as the default view by causing its <code>appEvent</code>. <strong>Giraffe.Router</strong> also provides two utility functions to help you manage routes, <code>isCaused</code> and <code>getRoute</code>. We could have used <code>getRoute</code> to build our anchor links in <code>App.getHTML</code> above, but didn&#39;t for the sake of familiarity.</p>
<pre><code class="js">router.cause(<span class="string">'route:childView'</span>, <span class="number">1</span>);
router.isCaused(<span class="string">'route:childView'</span>, <span class="number">1</span>); <span class="comment">// =&gt; true</span>
router.isCaused(<span class="string">'route:childView'</span>, <span class="number">2</span>); <span class="comment">// =&gt; false</span>
router.isCaused(<span class="string">'route:childView'</span>);    <span class="comment">// =&gt; false</span>
router.getRoute(<span class="string">'route:childView'</span>, <span class="number">1</span>); <span class="comment">// =&gt; '#childView/1'</span></code></pre>
<p><strong>Please note:</strong> you won&#39;t see hash changes in your address bar because the example is in an iframe, but your browser&#39;s back and forward buttons should work!</p>
<h2>Try It</h2>
<div id="routersandappevents0_tabs" class="tabs">
  <ul>
    <li class="active">
  <a href="#routersandappevents0result-tab" rel="routersandappevents0result-tab">
    result
  </a>
</li><li>
  <a href="#routersandappevents0scriptjs-tab" rel="routersandappevents0scriptjs-tab">
    script.js
  </a>
</li><li>
  <a href="#routersandappevents0markuphtml-tab" rel="routersandappevents0markuphtml-tab">
    markup.html
  </a>
</li><li>
  <a href="#routersandappevents0stylecss-tab" rel="routersandappevents0stylecss-tab">
    style.css
  </a>
</li>
  </ul>
</div>
<div id="routersandappevents0_tabs_content" class="tabs_content">
  <div id="routersandappevents0result-tab" class="tab_content">
  <iframe id="routersandappevents0" src="_assets/routersandappevents0.html" class="result"></iframe>
</div><div id="routersandappevents0scriptjs-tab" class="tab_content">
  <pre><code class="language-js"><span class="keyword">var</span> App, ChildView;

App = Giraffe.App.extend({

  getHTML: <span class="keyword">function</span>() {
    <span class="keyword">var</span> html = <span class="string">''</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/1"&gt;show child view 1&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/2"&gt;show child view 2&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;p&gt;&lt;a href="#childView/3"&gt;show child view 3&lt;/a&gt;&lt;/p&gt;'</span>;
    html += <span class="string">'&lt;div id="child-view-container"&gt;&lt;/div&gt;'</span>;
    <span class="keyword">return</span> html;
  },

  appEvents: {
    <span class="string">'route:childView'</span>: <span class="string">'showChildView'</span>,
    <span class="string">'all'</span>: <span class="keyword">function</span>() { console.log(<span class="string">'app event'</span>, arguments); } <span class="comment">// log to see what's happening</span>
    <span class="comment">// 'some:otherRoute': 'someFunctionName'</span>
    <span class="comment">// 'some:otherAppEvent': 'someOtherFunctionName'</span>
  },

  showChildView: <span class="keyword">function</span>(name) {
    <span class="keyword">this</span>.attach(<span class="keyword">new</span> ChildView({name: name}), {el: <span class="string">'#child-view-container'</span>, method: <span class="string">'html'</span>});
  }
});

ChildView = Giraffe.View.extend({
  className: <span class="string">'child-view'</span>,

  initialize: <span class="keyword">function</span>(options) {
    <span class="keyword">this</span>.name = <span class="string">'child view '</span> + <span class="keyword">this</span>.options.name;
    <span class="keyword">var</span> color;
    <span class="keyword">if</span> (options.name === <span class="string">'1'</span>)
      color = <span class="string">'#e99'</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> (options.name === <span class="string">'2'</span>)
      color = <span class="string">'#9e9'</span>;
    <span class="keyword">else</span>
      color = <span class="string">'#99e'</span>;
    <span class="keyword">this</span>.$el.css(<span class="string">'background-color'</span>, color);
  },

  getHTML: <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="string">'&lt;h2&gt;'</span> + <span class="keyword">this</span>.name + <span class="string">'&lt;/h2&gt;'</span>;
  }
});

<span class="keyword">var</span> app = <span class="keyword">new</span> App();
app.attachTo(<span class="string">'body'</span>);

<span class="keyword">var</span> router = <span class="keyword">new</span> Giraffe.Router({
  triggers: {
    <span class="string">'childView/:name'</span>: <span class="string">'route:childView'</span>
    <span class="comment">// 'someHashLocation/:andItsParams': 'some:appEvent'</span>
  }
  <span class="comment">// app: someApp // to set an app other than Giraffe.app</span>
});

router.app === Giraffe.app; <span class="comment">// =&gt; true</span>

<span class="comment">// Alternatively:</span>
<span class="comment">// var Router = Giraffe.Router.extend({triggers: {...}});</span>
<span class="comment">// var router = new Router();</span>

Backbone.history.start();

router.cause(<span class="string">'route:childView'</span>, <span class="number">1</span>);
router.isCaused(<span class="string">'route:childView'</span>, <span class="number">1</span>); <span class="comment">// =&gt; true</span>
router.isCaused(<span class="string">'route:childView'</span>, <span class="number">2</span>); <span class="comment">// =&gt; false</span>
router.isCaused(<span class="string">'route:childView'</span>);    <span class="comment">// =&gt; false</span>
router.getRoute(<span class="string">'route:childView'</span>, <span class="number">1</span>); <span class="comment">// =&gt; '#childView/1'</span></code></pre>
</div><div id="routersandappevents0markuphtml-tab" class="tab_content">
  <pre><code class="language-html"><span class="doctype">&lt;!DOCTYPE html&gt;</span>
<span class="tag">&lt;<span class="title">html</span>&gt;</span>
  <span class="tag">&lt;<span class="title">head</span>&gt;</span>
    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">'stylesheet'</span> <span class="attribute">type</span>=<span class="value">'text/css'</span> <span class="attribute">href</span>=<span class="value">'../css/normalize.css'</span> /&gt;</span>
    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">rel</span>=<span class="value">'stylesheet'</span> <span class="attribute">type</span>=<span class="value">'text/css'</span> <span class="attribute">href</span>=<span class="value">'routersandappevents0-style.css'</span> /&gt;</span>
  <span class="tag">&lt;/<span class="title">head</span>&gt;</span>
  <span class="tag">&lt;<span class="title">body</span>&gt;</span>
    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://code.jquery.com/jquery-1.9.1.min.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.0.0/backbone-min.js"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
<span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"../../backbone.giraffe.js"</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
    <span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">'routersandappevents0-script.js'</span>&gt;</span><span class="javascript"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</code></pre>
</div><div id="routersandappevents0stylecss-tab" class="tab_content">
  <pre><code class="language-css">// Example
body {
  background-color: #ffffff;
  padding: 20px;
  font-size: 14px;
  font-family: Verdana, Geneva, sans-serif;
}
* {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
h1 {
  font-size: 42px;
}
h2 {
  font-size: 24px;
  margin-bottom: 20px;
  display: inline;
  margin-right: 10px;
}
h3 {
  font-size: 18px;
  display: inline;
  margin-right: 10px;
}
.child-view {
  position: relative;
  padding: 20px;
  margin: 20px;
  border: 1px dashed #999;
}</code></pre>
</div>
</div></div></p>

      </article>
    </div>
  </div>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
  <script src="_assets/tutdown.js"></script>
  <script>
  $(function() {
    $('.more-details').click(function() {
      $this = $(this);
      if ($this.hasClass('collapsed')) {
        $this.removeClass('collapsed');
        $this.addClass('uncollapsed');
      } else {
        $this.removeClass('uncollapsed');
        $this.addClass('collapsed');
      }
    });
  });
  </script>
</body>
</html>

