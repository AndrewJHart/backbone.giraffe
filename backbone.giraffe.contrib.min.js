(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,n=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};t=Giraffe.Contrib={version:"0.1.3"},t.CollectionView=function(t){function i(){this.addOne=e(this.addOne,this);var t,n;if(i.__super__.constructor.apply(this,arguments),_.defaults(this,this.constructor.getDefaults(this)),!this.modelView)throw Error("`modelView` is required");if(!(null!=(t=this.collection)?t.model:void 0))throw Error("`collection.model` is required");this.listenTo(this.collection,"add",this.addOne),this.listenTo(this.collection,"remove",this.removeOne),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"sort",this.render),this.modelViewEl=(null!=(n=this.ui)?n[this.modelViewEl]:void 0)||this.modelViewEl}return n(i,t),i.getDefaults=function(t){return{collection:t.collection?null:new Giraffe.Collection,modelView:Giraffe.View,modelViewEl:null,modelViewArgs:null}},i.prototype._calcAttachOptions=function(t){var e,i,n,r,s;for(n={el:null,method:"prepend"},i=this.collection.indexOf(t),e=1;r=this.collection.at(i-e);){if(s=_.findWhere(this.children,{model:r}),null!=s?s._isAttached:void 0){n.method="after",n.el=s.$el;break}e++}if(!n.el&&this.modelViewEl&&(n.el=this.$el.find(this.modelViewEl),!n.el.length))throw Error("`modelViewEl` not found in this view");return n},i.prototype._cloneModelViewArgs=function(){var t;if(t=this.modelViewArgs||[{}],_.isFunction(t)&&(t=t.call(this)),_.isArray(t)||(t=[t]),t=_.map(t,_.clone),!_.isArray(t)||!_.isObject(t[0]))throw Error("`modelViewArgs` must be an array with an object as the first value");return t},i.prototype.afterRender=function(){return this.collection.each(this.addOne),this},i.prototype.removeOne=function(t){var e;return e=_.findWhere(this.children,{model:t}),null!=e&&e.dispose(),this},i.prototype.addOne=function(t){var e,i,n;return this.collection.contains(t)?this._renderedOnce?(e=this._calcAttachOptions(t),n=this._cloneModelViewArgs(),n[0].model=t,i=function(t,e,i){i.prototype=t.prototype;var n=new i,r=t.apply(n,e);return Object(r)===r?r:n}(this.modelView,n,function(){}),this.attach(i,e)):this.render():this.collection.add(t),this},i}(Giraffe.View)}).call(this);